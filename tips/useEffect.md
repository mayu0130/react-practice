# useEffectとは

Reactのコンポーネントにはライフサイクルという概念があります。

コンポーネントがレンダリングされたり、更新されたり、アンマウントされたりする際に、特定のタイミングで何かしらの処理を行いたい場合があります。
このような処理を「副作用」と呼びます。

useEffectフックは、このような副作用をReactコンポーネントに簡単に追加するための強力なツールです。

```
useEffect(() => {
  console.log('コンポーネントがマウントされた時とtodoListが更新された時に実行されます')


  //クリーンアップ関数の例
  return () => {
    console.log(コンポーネントがアンマウントされる時に実行されます);
  };
}, [todoLLst]); //依存配列
```

## useEffectの使用方法パターン

**第二引数がない場合**
```
useEffect(() => {
  //副作用の処理
});
```
- 第二引数を指定しない場合、useEffectは毎回レンダリングの後に実行されます。
- つまり、コンポーネントがマウントされたときだけでなく、ステートやプロパティが変わってレンダリングが再実行されるたびに、useEffectのコールバック関数が実行されます。

依存関係が多い、または全てのレンダリングの後に処理を実行したい場合に使用します。

**第二引数が空配列の場合**
```
useEffect(() => {
  //副作用の処理
}, []);
```
- 第二引数として空の配列を指定すると、useEffectはコンポーネントが最初にマウントされたとき一度だけ実行されます。
- その後。どのような状態の変更があっても、useEffectは再度実行されません。

コンポーネントの初回マウント時にのみ実行したい処理、例えば初期データのフェッチや一度だけ実行する設定処理に使用します。

**変数が配列に含まれる場合**
```
useEffect(() => {
  //副作用の処理
}, [todoList]);
```
- 依存配列内に特定の変数(例 todoList)を指定すると、その変数が変更されるたびにuseEffectが再実行されます。
- 例えばtodoListというステートが変更されるたびに、useEffectの処理が実行されます。
- 初回のマウント時にも一度実行されます。

特定のステートやプロパティが変わった時にのみ処理を行いたい場合に使用します。例えば、ユーザが入力した値に基づいて、何かを計算したり、APIリクエストを発行したりする場合に便利です。

---

レンダリング：コンポーネントがどのように表示されるかを準備すること。データが変わるたびに何度も行われます。
マウント：コンポーネントがｈじめて画面に表示される瞬間のこと。一度きりの動作です。


関数コンポーネントにおけるマウント時には、主に以下のことが行われます。
1.コンポーネント関数自体の実行
2.useStateでの状態の初期化
3.useEffectによる副作用に実行
4.JSXを基にしたDOMの生成と設定
5.必要に応じたrefの設定

再レンダリング時には、以下のことが行われます。
1.関数コンポーネントの再実行(stateやpropsの変化に基づく)
2.useStateの再評価(前回の値が保持される)
3.useEffectの再実行(依存配列に基づいた実行されるかどうかが決まる)
4.JSXの再評価と必要に応じたDOMの更新
5.必要に応じたrefの設定